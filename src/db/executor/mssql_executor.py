import xml.etree.ElementTree as ET
import time

XML = '<ShowPlanXML xmlns="http://schemas.microsoft.com/sqlserver/2004/07/showplan" Version="1.539" Build="15.0.2000.5"><BatchSequence><Batch><Statements><StmtSimple StatementText="SELECT count(*) FROM deliverer as deliverer&#xa;JOIN [order] as [order]&#xa;ON [order].deliverer_id = deliverer.id&#xa;JOIN customer as customer&#xa;ON customer.id = [order].customer_id&#xa;JOIN order_details as order_details&#xa;ON order_details.order_id = [order].id&#xa;JOIN discount as discount&#xa;ON discount.id = [order].discount_id&#xa;JOIN product as product&#xa;ON product.id = order_details.product_id&#xa;OPTION(FORCE ORDER)" StatementId="1" StatementCompId="2" StatementType="SELECT" RetrievedFromCache="true" StatementSubTreeCost="437.712" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xB6599B397979968A" QueryPlanHash="0x8C66C26EE64B77EE" CardinalityEstimationModelVersion="150" BatchModeOnRowStoreUsed="true"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="false" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan DegreeOfParallelism="7" MemoryGrant="19164496" CachedPlanSize="176" CompileTime="21" CompileCPU="21" CompileMemory="1112"><ThreadStat Branches="1" UsedThreads="7"><ThreadReservation NodeId="1" ReservedThreads="8"></ThreadReservation></ThreadStat><MissingIndexes><MissingIndexGroup Impact="17.0461"><MissingIndex Database="[order_db_unif]" Schema="[dbo]" Table="[order]"><ColumnGroup Usage="EQUALITY"><Column Name="[deliverer_id]" ColumnId="4"></Column></ColumnGroup><ColumnGroup Usage="INCLUDE"><Column Name="[customer_id]" ColumnId="2"></Column><Column Name="[discount_id]" ColumnId="5"></Column></ColumnGroup></MissingIndex></MissingIndexGroup><MissingIndexGroup Impact="61.8174"><MissingIndex Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]"><ColumnGroup Usage="EQUALITY"><Column Name="[order_id]" ColumnId="2"></Column></ColumnGroup><ColumnGroup Usage="INCLUDE"><Column Name="[product_id]" ColumnId="3"></Column></ColumnGroup></MissingIndex></MissingIndexGroup></MissingIndexes><MemoryGrantInfo SerialRequiredMemory="8192" SerialDesiredMemory="19115208" RequiredMemory="57464" DesiredMemory="19164496" RequestedMemory="19164496" GrantWaitTime="0" MaxQueryMemory="21346240" GrantedMemory="19164496" MaxUsedMemory="2179072" LastRequestedMemory="0" IsMemoryGrantFeedbackAdjusted="No: First Execution"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="629142" EstimatedPagesCached="786428" EstimatedAvailableDegreeOfParallelism="7" MaxCompileMemory="85734896"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2021-03-17T10:28:43.80" ModificationCount="0" SamplingPercent="0.75388" Statistics="[_WA_Sys_00000003_276EDEB3]" Table="[order_details]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-28T16:29:27.07" ModificationCount="0" SamplingPercent="100" Statistics="[customer_pkey]" Table="[customer]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-17T10:30:09.58" ModificationCount="0" SamplingPercent="1.57942" Statistics="[_WA_Sys_00000005_267ABA7A]" Table="[order]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-17T10:28:43.49" ModificationCount="0" SamplingPercent="0.75388" Statistics="[_WA_Sys_00000002_276EDEB3]" Table="[order_details]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-28T16:30:17.12" ModificationCount="0" SamplingPercent="100" Statistics="[order_pkey]" Table="[order]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-17T10:36:54.76" ModificationCount="0" SamplingPercent="1.57942" Statistics="[_WA_Sys_00000002_267ABA7A]" Table="[order]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-28T16:29:27.44" ModificationCount="0" SamplingPercent="100" Statistics="[discount_pkey]" Table="[discount]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-17T10:30:09.36" ModificationCount="0" SamplingPercent="1.57942" Statistics="[_WA_Sys_00000004_267ABA7A]" Table="[order]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-28T16:30:17.86" ModificationCount="0" SamplingPercent="100" Statistics="[product_pkey]" Table="[product]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo><StatisticsInfo LastUpdate="2021-03-28T16:29:27.42" ModificationCount="0" SamplingPercent="100" Statistics="[deliverer_pkey]" Table="[deliverer]" Schema="[dbo]" Database="[order_db_unif]"></StatisticsInfo></OptimizerStatsUsage><WaitStats><Wait WaitType="HTDELETE" WaitTimeMs="11292" WaitCount="72"></Wait><Wait WaitType="RESERVED_MEMORY_ALLOCATION_EXT" WaitTimeMs="2339" WaitCount="298332"></Wait><Wait WaitType="SOS_SCHEDULER_YIELD" WaitTimeMs="79" WaitCount="12995"></Wait><Wait WaitType="CMEMTHREAD" WaitTimeMs="55" WaitCount="1442"></Wait><Wait WaitType="HTBUILD" WaitTimeMs="47" WaitCount="72"></Wait><Wait WaitType="CXPACKET" WaitTimeMs="16" WaitCount="8"></Wait><Wait WaitType="HTREPARTITION" WaitTimeMs="15" WaitCount="60"></Wait><Wait WaitType="EXECSYNC" WaitTimeMs="11" WaitCount="84"></Wait><Wait WaitType="LATCH_EX" WaitTimeMs="8" WaitCount="32"></Wait><Wait WaitType="MEMORY_ALLOCATION_EXT" WaitTimeMs="4" WaitCount="1168"></Wait></WaitStats><QueryTimeStats ElapsedTime="9384" CpuTime="54245"></QueryTimeStats><RelOp NodeId="0" PhysicalOp="Parallelism" LogicalOp="Gather Streams" EstimateRows="1" EstimateIO="0" EstimateCPU="0.0285019" AvgRowSize="11" EstimatedTotalSubtreeCost="437.712" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1006"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="0" ActualRows="1" Batches="0" ActualExecutionMode="Row" ActualElapsedms="9384" ActualCPUms="0" ActualEndOfScans="1" ActualExecutions="1"></RunTimeCountersPerThread></RunTimeInformation><Parallelism><RelOp NodeId="1" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="1" EstimateIO="0" EstimateCPU="0" AvgRowSize="11" EstimatedTotalSubtreeCost="437.684" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Column="Expr1006"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="1" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1006"></ColumnReference><ScalarOperator ScalarString="CONVERT_IMPLICIT(int,[Expr1009],0)"><Convert DataType="int" Style="0" Implicit="1"><ScalarOperator><Identifier><ColumnReference Column="Expr1009"></ColumnReference></Identifier></ScalarOperator></Convert></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="2" PhysicalOp="Hash Match" LogicalOp="Aggregate" EstimateRows="1" EstimateIO="0" EstimateCPU="0.601775" AvgRowSize="11" EstimatedTotalSubtreeCost="437.684" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Column="Expr1009"></ColumnReference></OutputList><MemoryFractions Input="1" Output="1"></MemoryFractions><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="17" ActualCPUms="11" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="1" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="15" ActualCPUms="10" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="14" ActualCPUms="9" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="14" ActualCPUms="9" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="12" ActualCPUms="8" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="14" ActualCPUms="10" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="13" ActualCPUms="9" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><Hash><DefinedValues><DefinedValue><ColumnReference Column="Expr1009"></ColumnReference><ScalarOperator ScalarString="COUNT(*)"><Aggregate Distinct="0" AggType="COUNT*"></Aggregate></ScalarOperator></DefinedValue></DefinedValues><HashKeysBuild></HashKeysBuild><RelOp NodeId="3" PhysicalOp="Adaptive Join" LogicalOp="Inner Join" EstimatedJoinType="Hash Match" AdaptiveThresholdRows="40220.9" EstimateRows="6e+07" EstimateIO="0" EstimateCPU="0.171429" AvgRowSize="9" EstimatedTotalSubtreeCost="437.254" Parallel="1" IsAdaptive="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="10280020" Batches="11423" ActualExecutionMode="Batch" ActualElapsedms="7" ActualCPUms="3" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="8812756" Batches="9793" ActualExecutionMode="Batch" ActualElapsedms="6" ActualCPUms="2" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="10283743" Batches="11427" ActualExecutionMode="Batch" ActualElapsedms="7" ActualCPUms="3" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="8192347" Batches="9103" ActualExecutionMode="Batch" ActualElapsedms="6" ActualCPUms="2" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="7158302" Batches="7955" ActualExecutionMode="Batch" ActualElapsedms="5" ActualCPUms="2" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="6856369" Batches="7619" ActualExecutionMode="Batch" ActualElapsedms="5" ActualCPUms="2" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="8416463" Batches="9352" ActualExecutionMode="Batch" ActualElapsedms="6" ActualCPUms="2" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0" ActualJoinType="Hash Match"></RunTimeCountersPerThread></RunTimeInformation><AdaptiveJoin Optimized="0"><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Alias="[product]" Column="id"></ColumnReference></HashKeysProbe><ProbeResidual><ScalarOperator ScalarString="[order_db_unif].[dbo].[order_details].[product_id] as [order_details].[product_id]=[order_db_unif].[dbo].[product].[id] as [product].[id]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Alias="[product]" Column="id"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></ProbeResidual><OuterReferences><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></OuterReferences><RelOp NodeId="5" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="6e+07" EstimateIO="0" EstimateCPU="17.9392" AvgRowSize="15" EstimatedTotalSubtreeCost="415.968" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></OutputList><MemoryFractions Input="0.695999" Output="0.695999"></MemoryFractions><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="2624" ActualCPUms="1230" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="16439871" Batches="18268" ActualExecutionMode="Batch" ActualElapsedms="1710" ActualCPUms="1647" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="16444449" Batches="18273" ActualExecutionMode="Batch" ActualElapsedms="1599" ActualCPUms="1577" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="2804" ActualCPUms="1403" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="10559233" Batches="11734" ActualExecutionMode="Batch" ActualElapsedms="1972" ActualCPUms="1428" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="2652" ActualCPUms="1259" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="16556447" Batches="18397" ActualExecutionMode="Batch" ActualElapsedms="1812" ActualCPUms="1797" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[discount]" Alias="[discount]" Column="id"></ColumnReference></HashKeysProbe><ProbeResidual><ScalarOperator ScalarString="[order_db_unif].[dbo].[discount].[id] as [discount].[id]=[order_db_unif].[dbo].[order].[discount_id] as [order].[discount_id]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[discount]" Alias="[discount]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></ProbeResidual><RelOp NodeId="6" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="6e+07" EstimateIO="0" EstimateCPU="12.9163" AvgRowSize="23" EstimatedTotalSubtreeCost="398.023" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></OutputList><MemoryFractions Input="0.365502" Output="0.365502"></MemoryFractions><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="7302680" Batches="8115" ActualExecutionMode="Batch" ActualElapsedms="2938" ActualCPUms="1799" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="8776013" Batches="9752" ActualExecutionMode="Batch" ActualElapsedms="2777" ActualCPUms="2028" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="7242340" Batches="8048" ActualExecutionMode="Batch" ActualElapsedms="2960" ActualCPUms="1748" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="11005734" Batches="12229" ActualExecutionMode="Batch" ActualElapsedms="2443" ActualCPUms="2328" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="6951362" Batches="7724" ActualExecutionMode="Batch" ActualElapsedms="3074" ActualCPUms="1737" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="7852322" Batches="8725" ActualExecutionMode="Batch" ActualElapsedms="2894" ActualCPUms="1901" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="10869549" Batches="12078" ActualExecutionMode="Batch" ActualElapsedms="2378" ActualCPUms="2364" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="order_id"></ColumnReference></HashKeysProbe><ProbeResidual><ScalarOperator ScalarString="[order_db_unif].[dbo].[order_details].[order_id] as [order_details].[order_id]=[order_db_unif].[dbo].[order].[id] as [order].[id]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="order_id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></ProbeResidual><RelOp NodeId="7" PhysicalOp="Adaptive Join" LogicalOp="Inner Join" EstimatedJoinType="Hash Match" AdaptiveThresholdRows="150338" EstimateRows="2e+07" EstimateIO="0" EstimateCPU="0.0571429" AvgRowSize="23" EstimatedTotalSubtreeCost="127.437" Parallel="1" IsAdaptive="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="2919537" Batches="3260" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="2757025" Batches="3079" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="2662584" Batches="2973" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="2877739" Batches="3213" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="3008235" Batches="3359" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="3011381" Batches="3362" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="2763499" Batches="3086" ActualExecutionMode="Batch" ActualElapsedms="3" ActualCPUms="1" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1" ActualJoinType="Hash Match"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0" ActualJoinType="Hash Match"></RunTimeCountersPerThread></RunTimeInformation><AdaptiveJoin Optimized="0"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></DefinedValue></DefinedValues><HashKeysBuild><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Alias="[customer]" Column="id"></ColumnReference></HashKeysProbe><ProbeResidual><ScalarOperator ScalarString="[order_db_unif].[dbo].[customer].[id] as [customer].[id]=[order_db_unif].[dbo].[order].[customer_id] as [order].[customer_id]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Alias="[customer]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></ProbeResidual><OuterReferences><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference></OuterReferences><RelOp NodeId="9" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="2e+07" EstimateIO="0" EstimateCPU="2.84092" AvgRowSize="31" EstimatedTotalSubtreeCost="95.7782" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></OutputList><MemoryFractions Input="5.02433e-06" Output="5.02433e-06"></MemoryFractions><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="2770512" Batches="3079" ActualExecutionMode="Batch" ActualElapsedms="35" ActualCPUms="20" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="2983673" Batches="3316" ActualExecutionMode="Batch" ActualElapsedms="25" ActualCPUms="22" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="2786927" Batches="3097" ActualExecutionMode="Batch" ActualElapsedms="39" ActualCPUms="20" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="2906617" Batches="3230" ActualExecutionMode="Batch" ActualElapsedms="44" ActualCPUms="27" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="2984520" Batches="3317" ActualExecutionMode="Batch" ActualElapsedms="45" ActualCPUms="20" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="2841405" Batches="3158" ActualExecutionMode="Batch" ActualElapsedms="50" ActualCPUms="20" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="2726346" Batches="3030" ActualExecutionMode="Batch" ActualElapsedms="48" ActualCPUms="22" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[deliverer]" Alias="[deliverer]" Column="id"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="deliverer_id"></ColumnReference></HashKeysProbe><ProbeResidual><ScalarOperator ScalarString="[order_db_unif].[dbo].[order].[deliverer_id] as [order].[deliverer_id]=[order_db_unif].[dbo].[deliverer].[id] as [deliverer].[id]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="deliverer_id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[deliverer]" Alias="[deliverer]" Column="id"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></ProbeResidual><RelOp NodeId="10" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="4" EstimatedRowsRead="4" EstimateIO="0.003125" EstimateCPU="2.30571e-05" AvgRowSize="15" EstimatedTotalSubtreeCost="0.00314806" TableCardinality="4" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[deliverer]" Alias="[deliverer]" Column="id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="4" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="2" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="4" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[deliverer]" Alias="[deliverer]" Column="id"></ColumnReference></DefinedValue></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[deliverer]" Index="[deliverer_pkey]" Alias="[deliverer]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="11" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="2e+07" EstimatedRowsRead="2e+07" EstimateIO="89.7913" EstimateCPU="3.14288" AvgRowSize="39" EstimatedTotalSubtreeCost="92.9342" TableCardinality="2e+07" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="deliverer_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="2770512" Batches="3079" ActualExecutionMode="Batch" ActualElapsedms="474" ActualCPUms="474" ActualScans="1" ActualLogicalReads="16971" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2770512" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="2983673" Batches="3316" ActualExecutionMode="Batch" ActualElapsedms="471" ActualCPUms="470" ActualScans="1" ActualLogicalReads="18271" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2983673" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="2786927" Batches="3097" ActualExecutionMode="Batch" ActualElapsedms="466" ActualCPUms="465" ActualScans="1" ActualLogicalReads="17071" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2786927" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="2906617" Batches="3230" ActualExecutionMode="Batch" ActualElapsedms="466" ActualCPUms="466" ActualScans="1" ActualLogicalReads="17806" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2906617" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="2984520" Batches="3317" ActualExecutionMode="Batch" ActualElapsedms="462" ActualCPUms="461" ActualScans="1" ActualLogicalReads="18278" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2984520" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="2841405" Batches="3158" ActualExecutionMode="Batch" ActualElapsedms="460" ActualCPUms="459" ActualScans="1" ActualLogicalReads="17406" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2841405" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="2726346" Batches="3030" ActualExecutionMode="Batch" ActualElapsedms="451" ActualCPUms="451" ActualScans="1" ActualLogicalReads="16705" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="2726346" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="deliverer_id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="discount_id"></ColumnReference></DefinedValue></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Index="[order_pkey]" Alias="[order]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Hash></RelOp><RelOp NodeId="12" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="5e+06" EstimatedRowsRead="5e+06" EstimateIO="23.4461" EstimateCPU="0.785737" AvgRowSize="15" EstimatedTotalSubtreeCost="24.2318" TableCardinality="5e+06" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Alias="[customer]" Column="id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="730201" Batches="812" ActualExecutionMode="Batch" ActualElapsedms="74" ActualCPUms="74" ActualScans="1" ActualLogicalReads="4672" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="730201" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="690499" Batches="768" ActualExecutionMode="Batch" ActualElapsedms="77" ActualCPUms="76" ActualScans="1" ActualLogicalReads="4421" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="690499" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="665625" Batches="740" ActualExecutionMode="Batch" ActualElapsedms="71" ActualCPUms="71" ActualScans="1" ActualLogicalReads="4258" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="665625" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="718911" Batches="799" ActualExecutionMode="Batch" ActualElapsedms="76" ActualCPUms="76" ActualScans="1" ActualLogicalReads="4604" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="718911" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="752080" Batches="836" ActualExecutionMode="Batch" ActualElapsedms="77" ActualCPUms="77" ActualScans="1" ActualLogicalReads="4810" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="752080" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="752080" Batches="836" ActualExecutionMode="Batch" ActualElapsedms="74" ActualCPUms="74" ActualScans="1" ActualLogicalReads="4810" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="752080" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="690604" Batches="768" ActualExecutionMode="Batch" ActualElapsedms="69" ActualCPUms="68" ActualScans="1" ActualLogicalReads="4422" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="690604" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Alias="[customer]" Column="id"></ColumnReference></DefinedValue></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Index="[customer_pkey]" Alias="[customer]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="15" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="9" EstimatedTotalSubtreeCost="437.684" TableCardinality="5e+06" Parallel="1" EstimateRebinds="2e+07" EstimateRewinds="3.00931" EstimatedExecutionMode="Row"><OutputList></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Index="[customer_pkey]" Alias="[customer]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[customer]" Alias="[customer]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[order_db_unif].[dbo].[order].[customer_id] as [order].[customer_id]"><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order]" Alias="[order]" Column="customer_id"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp></AdaptiveJoin></RelOp><RelOp NodeId="16" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="6e+07" EstimatedRowsRead="6e+07" EstimateIO="248.299" EstimateCPU="9.42859" AvgRowSize="23" EstimatedTotalSubtreeCost="257.727" TableCardinality="6e+07" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="order_id"></ColumnReference><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="7302680" Batches="8115" ActualExecutionMode="Batch" ActualElapsedms="942" ActualCPUms="937" ActualScans="1" ActualLogicalReads="41049" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="7302680" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="8776013" Batches="9752" ActualExecutionMode="Batch" ActualElapsedms="1047" ActualCPUms="1044" ActualScans="1" ActualLogicalReads="49301" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="8776013" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="7242340" Batches="8048" ActualExecutionMode="Batch" ActualElapsedms="952" ActualCPUms="950" ActualScans="1" ActualLogicalReads="40705" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="7242340" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="11005734" Batches="12229" ActualExecutionMode="Batch" ActualElapsedms="1274" ActualCPUms="1268" ActualScans="1" ActualLogicalReads="61790" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="11005734" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="6951362" Batches="7724" ActualExecutionMode="Batch" ActualElapsedms="858" ActualCPUms="855" ActualScans="1" ActualLogicalReads="39083" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="6951362" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="7852322" Batches="8725" ActualExecutionMode="Batch" ActualElapsedms="969" ActualCPUms="965" ActualScans="1" ActualLogicalReads="44140" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="7852322" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="10869549" Batches="12078" ActualExecutionMode="Batch" ActualElapsedms="1275" ActualCPUms="1272" ActualScans="1" ActualLogicalReads="61027" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="10869549" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="order_id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></DefinedValue></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Index="[order_details_pkey]" Alias="[order_details]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Hash></RelOp><RelOp NodeId="17" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="500" EstimatedRowsRead="500" EstimateIO="0.00534722" EstimateCPU="0.000101" AvgRowSize="15" EstimatedTotalSubtreeCost="0.00544822" TableCardinality="500" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[discount]" Alias="[discount]" Column="id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="137" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="3" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="137" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="137" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="3" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="137" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="88" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="2" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="88" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="138" Batches="1" ActualExecutionMode="Batch" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="3" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="138" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[discount]" Alias="[discount]" Column="id"></ColumnReference></DefinedValue></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[discount]" Index="[discount_pkey]" Alias="[discount]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Hash></RelOp><RelOp NodeId="18" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="1e+06" EstimatedRowsRead="1e+06" EstimateIO="6.17794" EstimateCPU="0.157165" AvgRowSize="15" EstimatedTotalSubtreeCost="6.33511" TableCardinality="1e+06" Parallel="1" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Batch"><OutputList><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Alias="[product]" Column="id"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="171360" Batches="191" ActualExecutionMode="Batch" ActualElapsedms="19" ActualCPUms="19" ActualScans="1" ActualLogicalReads="1443" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="171360" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="146893" Batches="164" ActualExecutionMode="Batch" ActualElapsedms="17" ActualCPUms="17" ActualScans="1" ActualLogicalReads="1240" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="146893" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="171361" Batches="191" ActualExecutionMode="Batch" ActualElapsedms="18" ActualCPUms="18" ActualScans="1" ActualLogicalReads="1443" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="171361" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="136537" Batches="152" ActualExecutionMode="Batch" ActualElapsedms="22" ActualCPUms="22" ActualScans="1" ActualLogicalReads="1151" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="136537" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="119283" Batches="133" ActualExecutionMode="Batch" ActualElapsedms="13" ActualCPUms="13" ActualScans="1" ActualLogicalReads="1010" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="119283" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="114240" Batches="127" ActualExecutionMode="Batch" ActualElapsedms="13" ActualCPUms="13" ActualScans="1" ActualLogicalReads="962" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="114240" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="140326" Batches="156" ActualExecutionMode="Batch" ActualElapsedms="16" ActualCPUms="15" ActualScans="1" ActualLogicalReads="1191" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="140326" ActualEndOfScans="0" ActualExecutions="1"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Alias="[product]" Column="id"></ColumnReference></DefinedValue></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Index="[product_pkey]" Alias="[product]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="21" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="9" EstimatedTotalSubtreeCost="437.684" TableCardinality="1e+06" Parallel="1" EstimateRebinds="5.99999e+07" EstimateRewinds="59.0284" EstimatedExecutionMode="Row"><OutputList></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="7" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="6" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="5" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="4" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="3" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="2" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="1" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread><RunTimeCountersPerThread Thread="0" ActualRows="0" Batches="0" ActualExecutionMode="Row" ActualElapsedms="0" ActualCPUms="0" ActualScans="0" ActualLogicalReads="0" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualEndOfScans="0" ActualExecutions="0"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Index="[product_pkey]" Alias="[product]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[product]" Alias="[product]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[order_db_unif].[dbo].[order_details].[product_id] as [order_details].[product_id]"><Identifier><ColumnReference Database="[order_db_unif]" Schema="[dbo]" Table="[order_details]" Alias="[order_details]" Column="product_id"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp></AdaptiveJoin></RelOp></Hash></RelOp></ComputeScalar></RelOp></Parallelism></RelOp></QueryPlan></StmtSimple></Statements></Batch></BatchSequence></ShowPlanXML>'
namespace = {'mw': 'http://schemas.microsoft.com/sqlserver/2004/07/showplan'}


def execute_sql_query(db_engine, schema, sql_query):
    con = db_engine.raw_connection()
    cursor = con.cursor()
    cursor.execute(sql_query)
    cursor.nextset()
    res_two = cursor.fetchall()
    xml_plan = res_two[0][0]
    filename = "query_execution-" + time.strftime("%Y-%m-%d-%H-%M-%S", time.gmtime(time.time())) + ".xml"
    f = open('./' + filename, 'w+')
    f.write(xml_plan)
    f.close()
    parsed = ET.ElementTree(ET.fromstring(xml_plan))
    costs = {}
    for elem in parsed.iter():
        traverse(elem, costs, schema, '')
    return costs


def traverse(current, costs, schema, path):
    if "relop" in current.tag.lower() and 'LogicalOp' in current.attrib and 'join' in current.attrib[
        'LogicalOp'].lower():

        runtime = current.findall('./mw:RunTimeInformation', namespaces=namespace)[0]
        join_info = \
            [node for node in current.getchildren() if
             node.find('./mw:HashKeysBuild', namespaces=namespace) is not None][0]
        cost = max([thread.attrib['ActualElapsedms'] for thread in runtime.getchildren()])

        keyBuild = join_info.find('./mw:HashKeysBuild', namespaces=namespace)[0]
        keyProbe = join_info.find('./mw:HashKeysProbe', namespaces=namespace)[0]
        left = keyBuild.attrib['Table'].replace('[', '').replace(']', '')
        left_table = schema[left]
        right = keyProbe.attrib['Table'].replace('[', '').replace(']', '')
        right_table = schema[right]
        path = path + right_table.name if path != '' else left_table.name + '->' + right_table.name
        costs[path] = cost
        for child in current.getchildren():
            traverse(child, costs, schema, path)
